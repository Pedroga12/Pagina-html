<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@1,500&display=swap" rel="stylesheet">
    <title>Pokedex</title>
</head>
<body>
    <div class="container" style="border: 2px solid black; height: 985px; overflow-y: auto; width: 100%; max-width: 100%">
        <div class="row" id="cntPokemones" style="background-color: rgb(205, 248, 255);"></div>
    </div>
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
        }
        .card{
            height: 96%;
            max-height: 100%; 
            background-color: rgb(255, 221, 0); 
            padding: 10px; 
            margin: 10px;
            border-radius: 15px;
        }
        .cuerpo{
            height: 100%;
            background-color: rgb(144, 180, 128);
            border-radius: 10px;
        }
        .name{
            height: 50px;
        }
        .name-be{
            margin-top: 6px;
            height: 35px;
            padding: 4px 4px 4px 10px;
        }
        .sprites{
            height: 170px;
            width: 45% !important;
            align-items: center;
            margin-left: 110px;
        }
        .types{
            height: 20px;
        }
        .abilities{
            height: 200px;
        }
        .t{
            background-color: rgba(95, 158, 160, 0.506);
            height: 80px;
            padding-top: 8px;
        }   
        .h{
            background-color: rgba(95, 158, 160, 0.506);
            height: 120px;
            padding-top: 8px;
        }            
    </style>
    <script>
        const drawPokemons = (objData) => { // que son los parametros en una funcion js? 
            if(objData) { // validar siempre la informacion
                console.log (objData)
                /* for(let int = 0; int < objData.lenght; int ++) {
                    const detail = objData[int];
                }
                for(const k in objData) {
                    const detail = objData[k];
                } */
               let intNumero = 1;               
               const contenedor = document.getElementById("cntPokemones")                           
                objData.map(detail => {
                    if (!detail.types) return;
                    const nombrePokemon = detail.name,
                    numero = intNumero
                    let objTipos = detail.types,
                    intPeso = 0,
                    objHabilidades = {},
                    strImg = '',
                    intPuntosBase = 0;

                    intNumero = intNumero + 1;

                    if(detail?.base_experience) {
                        intPuntosBase = detail.base_experience;           
                    }

                    if(detail?.weight) {
                        intPeso = detail.weight;
                    }
                    
                    if(detail?.abilities) {
                        objHabilidades = detail.abilities;
                    }

                    if(detail?.sprites) {
                        strImg = detail.sprites.front_shiny;
                    }

                    const sprites = detail.sprites;
                    const spriteUrls = [
                        sprites.front_default,
                        sprites.back_default,
                        sprites.front_shiny,
                        sprites.back_shiny,                                            
                    ];
                    
                    const validSprites = spriteUrls.filter(url => url);

                    const carouselItems = validSprites.map((url, index) => {
                        const activeClass = index === 0 ? 'active' : '';
                        return `
                            <div class="carousel-item ${activeClass}">
                                <img src="${url}" class="block w-100" alt="${nombrePokemon} image ${index + 1}">
                            </div>
                        `;
                    }).join('');

                    const carousel = `
                        <div id="carousel${intNumero}" class="carousel slide">
                            <div class="carousel-inner">
                                ${carouselItems}
                            </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#carousel${intNumero}" data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#carousel${intNumero}" data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        </div>
                    `;

                    const listaTipos = objTipos
                        .map(tipo=> `<li>${tipo.type.name}</li>`)
                        .join('');

                    const listHab = objHabilidades
                        .map(hab=> `<li>${hab.ability.name}</li>`)
                        .join('');

                    // encontrar la manera de manipular el elemento por su id con javascript

                    // aqui dibujas tu tarjeta de pokemon        
                    const maqueta = `
                            <div class="col-3" style="height: 500px; padding: 0px">
                                <div class="row card">
                                    <div class= "col-12 cuerpo">
                                        <div class="row name">                                            
                                            <div class="col-4 name-be">
                                                ${nombrePokemon}
                                            </div>                                                                                     
                                            <div class="col-3 offset-5 name-be text-end">
                                                ps ${intPuntosBase}                                               
                                            </div>
                                        </div>
                                        <div class="row sprites">
                                            ${carousel}
                                        </div>
                                        <div class="row abilities">
                                            <div class="col-12 t d-flex align-items-center">
                                                <ul>
                                                    ${listaTipos}
                                                </ul>
                                            </div>
                                            <div class="col-12 h d-flex align-items-center"> 
                                                <ul>
                                                    ${listHab}
                                                </ul>                                           
                                            </div>                                            
                                        </div>
                                        <div class="row" style="height: 30px">
                                            <div class="col-12 text-end" style="padding-top: 5px">
                                                Peso ${intPeso}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>`
                    contenedor.innerHTML += maqueta;
                    
                        // apendizas la tarjeta en el contenedor que trajiste arriba

                                       
                   console.log(nombrePokemon, numero, intPeso, objTipos, objHabilidades, strImg, intPuntosBase);
                 
                    
                });
            }
        };

        // por que existe el async - await en js
        const getFile = async () => { // arrow function
            const data = await fetch('pokemones.json');
            let arr = [];
            try {
                arr = await data.json();
            } catch(error) {
                arr = [];
            }

            // averiguar los estados que responden los servidores
            // 200, 400, 500
            if(arr?.status == 200){ // que son operadores ternarios en js
                drawPokemons(arr?.results);
            }
        };

        getFile();
    </script>
</body>
</html>