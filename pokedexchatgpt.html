<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@1,100..900&display=swap" rel="stylesheet">    <title>Pokedex</title>
</head>
<body>
    <div class="container" style="width: 100%; max-width: 100%; margin-top: 40px;">
        <div class="row" style="position: fixed; top: 0; z-index: 100; width: 100%; background-color: rgb(92, 210, 247); height: 40px;">   
            <div class="col-12" style="text-align: center;">  
                <button class="btn" style="color: white; margin: 0px 15px 0px 15px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-backpack2" viewBox="0 0 16 16">
                        <path d="M4.04 7.43a4 4 0 0 1 7.92 0 .5.5 0 1 1-.99.14 3 3 0 0 0-5.94 0 .5.5 0 1 1-.99-.14"/>
                        <path fill-rule="evenodd" d="M4 9.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5zm1 .5v3h6v-3h-1v.5a.5.5 0 0 1-1 0V10z"/>
                        <path d="M6 2.341V2a2 2 0 1 1 4 0v.341c2.33.824 4 3.047 4 5.659v1.191l1.17.585a1.5 1.5 0 0 1 .83 1.342V13.5a1.5 1.5 0 0 1-1.5 1.5h-1c-.456.607-1.182 1-2 1h-7a2.5 2.5 0 0 1-2-1h-1A1.5 1.5 0 0 1 0 13.5v-2.382a1.5 1.5 0 0 1 .83-1.342L2 9.191V8a6 6 0 0 1 4-5.659M7 2v.083a6 6 0 0 1 2 0V2a1 1 0 0 0-2 0M3 13.5A1.5 1.5 0 0 0 4.5 15h7a1.5 1.5 0 0 0 1.5-1.5V8A5 5 0 0 0 3 8zm-1-3.19-.724.362a.5.5 0 0 0-.276.447V13.5a.5.5 0 0 0 .5.5H2zm12 0V14h.5a.5.5 0 0 0 .5-.5v-2.382a.5.5 0 0 0-.276-.447L14 10.309Z"/>
                    </svg>
                </button>
                <button class="btn" style="color: white; margin: 0px 15px 0px 15px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bar-chart-steps" viewBox="0 0 16 16">
                        <path d="M.5 0a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-1 0V.5A.5.5 0 0 1 .5 0M2 1.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-4a.5.5 0 0 1-.5-.5zm2 4a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5zm2 4a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-6a.5.5 0 0 1-.5-.5zm2 4a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5z"/>
                    </svg>
                </button>
                <button class="btn" style="color: white; margin: 0px 15px 0px 15px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard2-x" viewBox="0 0 16 16">
                        <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 5 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5z"/>
                        <path d="M3 2.5a.5.5 0 0 1 .5-.5H4a.5.5 0 0 0 0-1h-.5A1.5 1.5 0 0 0 2 2.5v12A1.5 1.5 0 0 0 3.5 16h9a1.5 1.5 0 0 0 1.5-1.5v-12A1.5 1.5 0 0 0 12.5 1H12a.5.5 0 0 0 0 1h.5a.5.5 0 0 1 .5.5v12a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5z"/>
                        <path d="M8 8.293 6.854 7.146a.5.5 0 1 0-.708.708L7.293 9l-1.147 1.146a.5.5 0 0 0 .708.708L8 9.707l1.146 1.147a.5.5 0 0 0 .708-.708L8.707 9l1.147-1.146a.5.5 0 0 0-.708-.708z"/>
                    </svg>
                </button>
            </div>
        </div>    
        <div class="row" id="cntPokemones" style="background-color: rgb(205, 248, 255);"></div>         
    </div>
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
        }
        .card{
            height: 96%;
            max-height: 100%; 
            background-color: rgb(255, 221, 0); 
            padding: 10px; 
            margin: 10px;
            border-radius: 15px;
        }
        .cuerpo{
            height: 100%;
            background-color: rgb(144, 180, 128);
            border-radius: 10px;
        }
        .name{
            height: 45px;
            background-color: rgba(95, 158, 160, 0.506);
        }
        .name-be{
            margin-top: 6px;
            height: 35px;
            padding: 4px 4px 4px 10px;
            text-transform: capitalize;
        }
        .sprites{
            height: 170px;
            align-items: center;
        }
        .types{
            height: 20px;
        }
        .abilities{
            height: 200px;
        }
        .t{
            background-color: rgba(95, 158, 160, 0.506);
            height: 92px;
        }   
        .h{
            background-color: rgba(95, 158, 160, 0.506);
            height: 110px;
            margin-top: 5px;
        }            
        .negra{
            font-weight: 700 !important;
        }
    </style>
<script>
    const drawPokemons = (objData) => { 
        if (objData) {
            let intNumero = 1;
            const contenedor = document.getElementById("cntPokemones");
            contenedor.innerHTML = ''; 
            objData.map(detail => {
                if (!detail.types) return;

                const nombrePokemon = detail.name;
                const numero = intNumero;
                let objTipos = detail.types;
                let intPeso = 0;
                let objHabilidades = {};
                let strImg = '';
                let intPuntosBase = 0;

                intNumero++;

                if (detail?.base_experience) {
                    intPuntosBase = detail.base_experience;
                }

                if (detail?.weight) {
                    intPeso = detail.weight;
                }

                if (detail?.abilities) {
                    objHabilidades = detail.abilities;
                }

                if (detail?.sprites) {
                    strImg = detail.sprites.front_shiny;
                }

                const sprites = detail.sprites;
                const spriteUrls = [
                    sprites.front_default,
                    sprites.back_default,
                    sprites.front_shiny,
                    sprites.back_shiny,
                ];

                const validSprites = spriteUrls.filter(url => url);

                const carouselItems = validSprites.map((url, index) => {
                    const activeClass = index === 0 ? 'active' : '';
                    return `
                        <div class="carousel-item ${activeClass}">
                            <img src="${url}" class="block w-100" alt="${nombrePokemon} image ${index + 1}">
                        </div>
                    `;
                }).join('');

                const carousel = `
                    <div id="carousel${intNumero}" class="carousel slide">
                        <div class="carousel-inner">
                            ${carouselItems}
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#carousel${intNumero}" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#carousel${intNumero}" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                `;

                const listaTipos = objTipos
                    .map(tipo => `<li>${tipo.type.name}</li>`)
                    .join('');

                const listHab = objHabilidades
                    .map(hab => `<li>${hab.ability.name}</li>`)
                    .join('');

                const maqueta = `
                    <div class="col-sm-12 col-md-4 col-lg-3" style="height: 500px; padding: 0px">
                        <div class="row card">
                            <div class="col-12 cuerpo">
                                <div class="row name">
                                    <div class="col-4 name-be negra">
                                        ${nombrePokemon}
                                    </div>
                                    <div class="col-3 offset-5 name-be text-end">
                                        ps ${intPuntosBase}
                                    </div>
                                </div>
                                <div class="row sprites">
                                    <div class="col-6 offset-3">
                                        ${carousel}
                                    </div>
                                </div>
                                <div class="row abilities">
                                    <div class="col-12 t align-items-center">
                                        <p class="negra">Tipos</p>
                                        <ul>
                                            ${listaTipos}
                                        </ul>
                                    </div>
                                    <div class="col-12 h align-items-center">
                                        <p class="negra">Habilidades</p>
                                        <ul>
                                            ${listHab}
                                        </ul>
                                    </div>
                                </div>
                                <div class="row" style="height: 30px">
                                    <div class="col-12 text-end" style="padding-top: 10px">
                                        Peso ${intPeso}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>`;
                contenedor.innerHTML += maqueta;
            });
        }
    };

    const showLoading = (state) => {
        const contenedor = document.getElementById("cntPokemones");
    };

    const getFilteredPokemons = async (filterType) => {
        const data = await fetch('pokemones.json');
        let arr = [];
        try {
            arr = await data.json();
        } catch (error) {
            arr = [];
        }

        const results = arr?.results || [];
        if (filterType === 1) {
            const completeData = results.filter(p =>
                p.name && p.weight && p.base_experience && p.abilities?.length > 0 && p.types?.length > 0
            );
            drawPokemons(completeData);
        } else if (filterType === 2) {
            const sortedByPs = results
                .filter(p => p.base_experience && p.base_experience >= 1)
                .sort((a, b) => a.base_experience - b.base_experience);
            drawPokemons(sortedByPs);
        } else if (filterType === 3) {
            const incompleteData = results.filter(p =>
                !(p.weight || p.base_experience || p.abilities?.length || p.types?.length)
            );
            const contenedor = document.getElementById("cntPokemones");
            const list = incompleteData
                .map(p => `<li>${p.name}</li>`)
                .join('');
            contenedor.innerHTML = `
                <div>
                    <p>Pokemones sin datos:</p>
                    <ul>
                        ${list}
                    </ul>
                </div>
            `;
        }
    };

    document.querySelectorAll(".btn").forEach((btn, index) => {
        btn.addEventListener("click", () => getFilteredPokemons(index + 1));
    });
</script>

</body>
</html>